<ul class="array-group-page-selector">
	<li><a href="#/stats/general"   ng-class="pageActive('general')">General</a></li>
	<li><a href="#/stats/event"     ng-class="pageActive('event')">Event URs</a></li>
	<li><a href="#/stats/festival"  ng-class="pageActive('festival')">Festival URs</a></li>
	<li><a href="#/stats/party"     ng-class="pageActive('party')">Party URs</a></li>
	<li><a href="#/stats/limited"   ng-class="pageActive('limited')">Festival + Party</a></li>
	<li><a href="#/stats/spotlight" ng-class="pageActive('spotlight')">Party + Spotlight</a></li>
	<li><a href="#/stats/gacha"     ng-class="pageActive('gacha')">Any Gacha UR</a></li>
	<li><a href="#/stats/ur"        ng-class="pageActive('ur')">Any UR</a></li>
	<li><a href="#/stats/sr"        ng-class="pageActive('sr')">Any SR</a></li>
</ul>

<div class="stats-category general" ng-if="isActive('general')">
	<h2>General Stats</h2>
	<p>Numbers of different types of cards.</p>
	{% for group, data in general_stats.items() %}
		<div class="stats-category-group {{ group.tag }}">
			<table class="stats-table general">
				<colgroup>
					<col style="width: 25%">
					
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					<col style="width: 7.5%">
					<col style="width: 7.5%">
				</colgroup>
				
				<thead>
					<tr>
						<th>{{ group.displayname }} Members</th>
						
						<th>URs</th>
						<th>SRs</th>
						
						<th colspan="2">Festival</th>
						<th colspan="2">Party</th>
						<th colspan="2">Event</th>
						<th colspan="2">Gacha</th>
					</tr>
				</thead>
				<tbody>
					{% for member, stats in data %}
						<tr class="idol-{{ member.value }}">
							<td class="idol-identity">
								<div class="flex-wrapper">
									<span class="idol-icon idol-icon-32-border idol-bg-color-dim"></span>
									<span class="idol-name">{{ Idols.by_member_id[member].full_name }}</span>
								</div>
							</td>
							
							<td class="stat-number">{{ stats['URs'] }}</td>
							<td class="stat-number">{{ stats['SRs'] }}</td>
							
							<td colspan="2" class="stat-number">{{ stats['festival'] }}</td>
							<td colspan="2" class="stat-number">{{ stats['party'] }}</td>
							<td colspan="2" class="stat-number">{{ stats['event'] }}</td>
							<td colspan="2" class="stat-number">{{ stats['gacha'] }}</td>
						</tr>
					{% endfor %}
				</tbody>
				
				<thead>
					<tr>
						<th>{{ group.name }} Members</th>
						<th colspan="6">Attributes</th>
						<th colspan="4">Types</th>
					</tr>
				</thead>
				<tbody>
					{% for member, stats in data %}
						<tr class="idol-{{ member.value }}">
							<td class="idol-identity">
								<div class="flex-wrapper">
									<span class="idol-icon idol-icon-32-border idol-bg-color-dim"></span>
									<span class="idol-name">{{ Idols.by_member_id[member].full_name }}</span>
								</div>
							</td>
							
							{% for attribute in Attribute %}
								<td class="stat-various {{ css('has-none', stats['attributes'][attribute] == 0) }} attribute-{{ attribute.value }} attribute-bg-color-dim" title="{{ attribute.name }}-attribute">
									<span class="icon-32 attribute-{{ attribute.value }}">{{ stats['attributes'][attribute] }}</span>
								</td>
							{% endfor %}
							{% for type in Type %}
								<td class="stat-various {{ css('has-none', stats['types'][type] == 0) }} type-{{ type.value }} type-bg-color-dim" title="{{ type.name }}-type">
									<span class="icon-32 type-{{ type.value }}">{{ stats['types'][type] }}</span>
								</td>
							{% endfor %}
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	{% endfor %}
</div>
	
{% for category_tag, category_data in card_stats.items() %}
	<div class="stats-category {{ category_tag }}" ng-if="isActive('{{ category_tag }}')">
		<h2>{{ categories[category_tag][0] }}</h2>
		<p>{{ categories[category_tag][1] }}</p>
		{% for group, data in category_data.items() %}
			<div class="stats-category-group {{ group.tag }}">
				<table class="stats-table {{ css('with-source', data.show_source) }}">
					<colgroup>
						<col style="width: 25%">
						<col style="width: 20%">
						<col style="width: 55%">
					</colgroup>
					<thead>
						<tr>
							<th>{{ group.displayname }} Members</th>
							<th colspan="2">Most Recent Card</th>
						</tr>
					</thead>
					
					{% for class, cards in [('non-reversed', data.cards), ('reversed', reversed(data.cards))] %}
						<tbody class="{{ class }}">
							{% for member, card, time_since in cards %}
								<tr class="idol-{{ member.value }}" data-index="{{ loop.index }}">
									<td class="idol-identity">
										<div class="flex-wrapper">
											<span class="idol-icon idol-icon-32-border idol-bg-color-dim"></span>
											<span class="idol-name">{{ Idols.by_member_id[member].full_name }}</span>
										</div>
									</td>
									{% if is_valid_card(card) %}
										<td title="Released on {{ card.release_date.strftime('%d %B %Y') }}">
											{{ time_since.days | format_days }}
										</td>
										<td class="card-details">
											<div class="flex-wrapper">
												<span class="thumbnail">
													<div class="thumbnail-wrapper">
														<a href="https://allstars.kirara.ca/card/{{ card.ordinal }}" target="_blank" class="card-thumbnail group-{{ card.group_id.value }}-{{ card.rarity.value }} card-{{ card.ordinal }}">
															<span class="source-indicator source-{{ card.source.value }}"></span>
														</a>
													</div>
												</span>
												<span class="card-link">
													{# <a href="https://allstars.kirara.ca/card/{{ card.ordinal }}" class="card-link-normal" target="_blank">{{ card.get_card_name(False) }}</a> #}
													<a href="https://allstars.kirara.ca/card/{{ card.ordinal }}" class="card-link-idolized" target="_blank">{{ card.get_card_name(True) }}</a>
												</span>
												{% if data.show_source %}
													<span class="card-source">
														{{ card.source.displayname }}
													</span>
												{% endif %}
											</div>
										</td>
									{% else %} 
										<td>
											Never
										</td>
										<td style="color: #aaa;">
											&mdash;
										</td>
									{% endif %}
								</tr>
							{% endfor %}
						</tbody>
					{% endfor %}
				</table>
			</div>
		{% endfor %}
	</div>
{% endfor %}
